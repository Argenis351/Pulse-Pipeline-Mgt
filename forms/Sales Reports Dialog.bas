Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =186
    PictureSizeMode =1
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =7681
    DatasheetFontHeight =11
    ItemSuffix =67
    Left =5558
    Top =3255
    Right =16928
    Bottom =12045
    DatasheetGridlinesColor =-1
    Tag ="Dialog~Extensions=WithoutLogo"
    RecSrcDt = Begin
        0x2b76abc017dde240
    End
    DatasheetFontName ="Calibri"
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    ShowPageMargins =0
    DatasheetAlternateBackColor =-2147483610
    PictureSizeMode =4
    DatasheetGridlinesColor12 =-1
    Begin
        Begin Label
            BackStyle =0
            TextFontCharSet =238
            FontSize =9
            BorderColor =12632256
            ForeColor =1462991
            FontName ="Arial"
        End
        Begin Rectangle
            BackStyle =0
            BorderLineStyle =0
            BorderColor =12632256
        End
        Begin Line
            BorderLineStyle =0
            BorderColor =12632256
        End
        Begin Image
            BackStyle =0
            BorderLineStyle =0
            PictureAlignment =2
            BorderColor =12632256
        End
        Begin CommandButton
            AddColon = NotDefault
            TextFontCharSet =238
            FontSize =9
            FontWeight =400
            ForeColor =1462991
            FontName ="Arial"
            BorderLineStyle =0
        End
        Begin OptionButton
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderColor =12632256
        End
        Begin CheckBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            BackStyle =1
            BorderLineStyle =0
            BorderColor =12632256
        End
        Begin BoundObjectFrame
            SizeMode =3
            BorderLineStyle =0
            LabelX =-1800
            BorderColor =12632256
        End
        Begin TextBox
            FELineBreak = NotDefault
            BorderLineStyle =0
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            AsianLineBreak =1
        End
        Begin ListBox
            BorderLineStyle =0
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
        End
        Begin ComboBox
            BorderLineStyle =0
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
        End
        Begin Subform
            BorderLineStyle =0
            BorderColor =12632256
        End
        Begin UnboundObjectFrame
            OldBorderStyle =1
            BorderColor =12632256
        End
        Begin CustomControl
            OldBorderStyle =1
            BorderColor =12632256
        End
        Begin ToggleButton
            AddColon = NotDefault
            TextFontCharSet =238
            FontSize =9
            FontWeight =400
            ForeColor =1462991
            FontName ="Arial"
            BorderLineStyle =0
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            BorderLineStyle =0
        End
        Begin Attachment
            BorderLineStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            BorderColor =12632256
            LabelX =-1800
        End
        Begin EmptyCell
            Height =240
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =1350
            Name ="FormHeader"
            AutoHeight =255
            BackThemeColorIndex =9
            Begin
                Begin Rectangle
                    BackStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    Top =735
                    Width =7681
                    Height =615
                    BorderColor =13750731
                    Name ="Box238"
                    HorizontalAnchor =2
                    LayoutCachedTop =735
                    LayoutCachedWidth =7681
                    LayoutCachedHeight =1350
                    BackThemeColorIndex =9
                    BackTint =20.0
                End
                Begin Label
                    OverlapFlags =85
                    TextFontCharSet =0
                    TextFontFamily =0
                    Left =263
                    Top =120
                    Width =7410
                    Height =543
                    FontSize =18
                    BorderColor =16251385
                    ForeColor =16777215
                    Name ="Auto_Title0"
                    Caption ="Sales Reports"
                    FontName ="Trebuchet"
                    LayoutCachedLeft =263
                    LayoutCachedTop =120
                    LayoutCachedWidth =7673
                    LayoutCachedHeight =663
                End
                Begin CommandButton
                    OverlapFlags =215
                    AccessKey =67
                    TextFontCharSet =0
                    Left =6593
                    Top =879
                    Width =826
                    Height =368
                    FontSize =11
                    TabIndex =2
                    Name ="cmdClose"
                    Caption ="&Close"
                    FontName ="Segoe UI"
                    UnicodeAccessKey =67
                    TopPadding =0
                    BottomPadding =0
                    HorizontalAnchor =1
                    OnClickEmMacro = Begin
                        Version =196611
                        ColumnsShown =8
                        Begin
                            Action ="Close"
                            Argument ="-1"
                            Argument =""
                            Argument ="0"
                        End
                        Begin
                            Comment ="_AXL:<?xml version=\"1.0\" encoding=\"UTF-16\" standalone=\"no\"?>\015\012<UserI"
                                "nterfaceMacro For=\"cmdClose\" xmlns=\"http://schemas.microsoft.com/office/acces"
                                "sservices/2009/11/application\"><Statements><Action Name=\"CloseWindow\"/></Stat"
                                "ements></UserInterfaceMacro>"
                        End
                    End
                    BackStyle =0

                    CursorOnHover =1
                    LayoutCachedLeft =6593
                    LayoutCachedTop =879
                    LayoutCachedWidth =7419
                    LayoutCachedHeight =1247
                    ForeThemeColorIndex =0
                    HoverForeThemeColorIndex =0
                    PressedForeThemeColorIndex =0
                    WebImagePaddingLeft =4
                    WebImagePaddingRight =3
                    WebImagePaddingBottom =-1
                    Overlaps =1
                End
                Begin CommandButton
                    OverlapFlags =215
                    AccessKey =80
                    TextFontCharSet =0
                    Left =233
                    Top =878
                    Width =645
                    Height =345
                    FontSize =11
                    Name ="cmdPrint"
                    Caption ="&Print"
                    OnClick ="[Event Procedure]"
                    FontName ="Segoe UI"
                    Tag ="Ignore"
                    UnicodeAccessKey =80
                    TopPadding =0
                    RightPadding =38
                    BottomPadding =8
                    BackStyle =0

                    CursorOnHover =1
                    LayoutCachedLeft =233
                    LayoutCachedTop =878
                    LayoutCachedWidth =878
                    LayoutCachedHeight =1223
                    ForeThemeColorIndex =0
                    HoverForeThemeColorIndex =0
                    PressedForeThemeColorIndex =0
                    WebImagePaddingLeft =4
                    WebImagePaddingRight =4
                    Overlaps =1
                End
                Begin CommandButton
                    Default = NotDefault
                    OverlapFlags =215
                    AccessKey =86
                    TextFontCharSet =0
                    Left =968
                    Top =878
                    Width =938
                    Height =368
                    FontSize =11
                    TabIndex =1
                    Name ="cmdPreview"
                    Caption ="Pre&view"
                    OnClick ="[Event Procedure]"
                    FontName ="Segoe UI"
                    Tag ="Ignore"
                    UnicodeAccessKey =118
                    TopPadding =0
                    RightPadding =38
                    BottomPadding =8
                    BackStyle =0

                    CursorOnHover =1
                    LayoutCachedLeft =968
                    LayoutCachedTop =878
                    LayoutCachedWidth =1906
                    LayoutCachedHeight =1246
                    ColumnStart =1
                    ColumnEnd =1
                    ForeThemeColorIndex =0
                    HoverForeThemeColorIndex =0
                    PressedForeThemeColorIndex =0
                    WebImagePaddingLeft =4
                    WebImagePaddingRight =4
                    Overlaps =1
                End
            End
        End
        Begin Section
            Height =3720
            Name ="Detail"
            Tag ="Detail"
            AlternateBackColor =14870503
            BackThemeColorIndex =1
            Begin
                Begin Line
                    OverlapFlags =85
                    Left =4140
                    Top =120
                    Width =0
                    Height =3474
                    Name ="Line57"
                End
                Begin ListBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =180
                    Top =600
                    Width =3780
                    Height =1665
                    Name ="lstSalesReports"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT [Sales Reports].[Group By], [Sales Reports].Title FROM [Sales Reports] OR"
                        "DER BY [Sales Reports].Title; "
                    ColumnWidths ="0;2880"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="=DLookUp(\"[Group By]\",\"Sales Reports\",\"[Default]\")"
                    FontName ="Segoe UI"
                    Tag ="Ignore"
                    AllowValueListEdits =1
                    InheritValueList =1

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =0
                            Left =180
                            Top =240
                            Width =2715
                            Height =317
                            FontSize =11
                            FontWeight =600
                            Name ="lstSalesReports_Label"
                            Caption ="Select Sales Report"
                            FontName ="Segoe UI"
                            ForeThemeColorIndex =0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =180
                    Top =2760
                    Width =3780
                    Height =315
                    TabIndex =4
                    Name ="lstReportFilter"
                    RowSourceType ="Table/Query"
                    FontName ="Segoe UI"
                    AllowValueListEdits =1
                    InheritValueList =1

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =0
                            Left =180
                            Top =2400
                            Width =2625
                            Height =315
                            FontSize =11
                            FontWeight =600
                            Name ="lstReportFilter_Label"
                            Caption ="Filter Sales Items..."
                            FontName ="Segoe UI"
                            ForeThemeColorIndex =0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ListWidth =1440
                    Left =5288
                    Top =2400
                    Width =2303
                    Height =315
                    TabIndex =2
                    Name ="cbYear"
                    RowSourceType ="Value List"
                    RowSource ="2002;2003;2004;2005"
                    ColumnWidths ="864"
                    DefaultValue ="=Year(GetLastOrderDate())"
                    FontName ="Segoe UI"
                    GroupTable =2
                    RightPadding =38
                    BottomPadding =38
                    AllowValueListEdits =1
                    InheritValueList =1

                    LayoutCachedLeft =5288
                    LayoutCachedTop =2400
                    LayoutCachedWidth =7591
                    LayoutCachedHeight =2715
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    GroupTable =2
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =0
                            Left =4350
                            Top =2400
                            Width =870
                            Height =315
                            FontSize =11
                            Name ="cbYear_Label"
                            Caption ="Year"
                            FontName ="Segoe UI"
                            GroupTable =2
                            BottomPadding =38
                            LayoutCachedLeft =4350
                            LayoutCachedTop =2400
                            LayoutCachedWidth =5220
                            LayoutCachedHeight =2715
                            LayoutGroup =1
                            ForeThemeColorIndex =0
                            GroupTable =2
                        End
                    End
                End
                Begin ListBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =4356
                    Top =600
                    Width =3210
                    Height =1665
                    TabIndex =1
                    Name ="lstSalesPeriod"
                    RowSourceType ="Value List"
                    RowSource ="1;\"Monthly Sales\";2;\"Quarterly Sales\";3;\"Yearly Sales\""
                    ColumnWidths ="0;2880"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Segoe UI"
                    Tag ="Ignore"
                    AllowValueListEdits =1
                    InheritValueList =1

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =0
                            Left =4356
                            Top =240
                            Width =2520
                            Height =317
                            FontSize =11
                            FontWeight =600
                            Name ="lstSalesPeriod_Label"
                            Caption ="Select Sales Period"
                            FontName ="Segoe UI"
                            ForeThemeColorIndex =0
                        End
                    End
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =5288
                    Top =2790
                    Width =2303
                    Height =315
                    TabIndex =3
                    Name ="cbQuarter"
                    RowSourceType ="Value List"
                    RowSource ="1;1st Quarter;2;2nd Quarter;3;3rd Quarter;4;4th Quarter"
                    ColumnWidths ="0;1008"
                    DefaultValue ="=Format(GetLastOrderDate(),\"q\")"
                    FontName ="Segoe UI"
                    GroupTable =2
                    RightPadding =38
                    BottomPadding =38
                    AllowValueListEdits =1
                    InheritValueList =1

                    LayoutCachedLeft =5288
                    LayoutCachedTop =2790
                    LayoutCachedWidth =7591
                    LayoutCachedHeight =3105
                    RowStart =1
                    RowEnd =1
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    GroupTable =2
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =0
                            Left =4350
                            Top =2790
                            Width =870
                            Height =315
                            FontSize =11
                            Name ="cbQuarter_Label"
                            Caption ="Quarter"
                            FontName ="Segoe UI"
                            GroupTable =2
                            BottomPadding =38
                            LayoutCachedLeft =4350
                            LayoutCachedTop =2790
                            LayoutCachedWidth =5220
                            LayoutCachedHeight =3105
                            RowStart =1
                            RowEnd =1
                            LayoutGroup =1
                            ForeThemeColorIndex =0
                            GroupTable =2
                        End
                    End
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =5288
                    Top =3180
                    Width =2303
                    Height =315
                    TabIndex =5
                    Name ="cbMonth"
                    RowSourceType ="Value List"
                    RowSource ="1;January;2;February;3;March;4;April;5;May;6;June;7;July;8;August;9;September;10"
                        ";October;11;November;12;December"
                    ColumnWidths ="0;1440"
                    DefaultValue ="=Month(GetLastOrderDate())"
                    FontName ="Segoe UI"
                    GroupTable =2
                    RightPadding =38
                    BottomPadding =38
                    AllowValueListEdits =1
                    InheritValueList =1

                    LayoutCachedLeft =5288
                    LayoutCachedTop =3180
                    LayoutCachedWidth =7591
                    LayoutCachedHeight =3495
                    RowStart =2
                    RowEnd =2
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    GroupTable =2
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontCharSet =0
                            Left =4350
                            Top =3180
                            Width =870
                            Height =315
                            FontSize =11
                            Name ="cbMonth_Label"
                            Caption ="Month"
                            FontName ="Segoe UI"
                            GroupTable =2
                            BottomPadding =38
                            LayoutCachedLeft =4350
                            LayoutCachedTop =3180
                            LayoutCachedWidth =5220
                            LayoutCachedHeight =3495
                            RowStart =2
                            RowEnd =2
                            LayoutGroup =1
                            ForeThemeColorIndex =0
                            GroupTable =2
                        End
                    End
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =240
                    Width =525
                    Height =60
                    Name ="cmdPrint_LayoutLabel"
                    Tag =";DoNotResize;"
                    GroupTable =3
                    TopPadding =0
                    RightPadding =38
                    BottomPadding =0
                    LayoutCachedLeft =240
                    LayoutCachedWidth =765
                    LayoutCachedHeight =60
                    LayoutGroup =2
                    GroupTable =3
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =840
                    Width =765
                    Height =60
                    Name ="cmdPreview_LayoutLabel"
                    Tag =";DoNotResize;"
                    GroupTable =3
                    TopPadding =0
                    RightPadding =38
                    BottomPadding =0
                    LayoutCachedLeft =840
                    LayoutCachedWidth =1605
                    LayoutCachedHeight =60
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =2
                    GroupTable =3
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =14870503
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Enum SalesPeriodEnum
    ByMonth = 1
    ByQuarter = 2
    ByYear = 3
End Enum


Sub PrintReports(ReportView As AcView)
    ' This procedure used in Preview_Click and Print_Click Sub procedures.
    ' Preview or print report selected in the ReportToPrint option group.
    ' Then close the Print Sales Reports Dialog form.
    Dim strReportName As String
    Dim strReportFilter As String
    Dim lOrderCount As Long

    ' Determine report filtering
    If Nz(Me.lstReportFilter) <> "" Then
        strReportFilter = "([SalesGroupingField] = """ & Me.lstReportFilter & """)"
    End If
    
    ' Determine reporting time frame
    Select Case Me.lstSalesPeriod
    Case ByYear
        strReportName = "Yearly Sales Report"
        lOrderCount = DCountWrapper("*", "Sales Analysis", "[Year]=" & Me.cbYear)
    Case ByQuarter
        strReportName = "Quarterly Sales Report"
        lOrderCount = DCountWrapper("*", "Sales Analysis", "[Year]=" & Me.cbYear & " AND [Quarter]=" & Me.cbQuarter)
    Case ByMonth
        strReportName = "Monthly Sales Report"
        lOrderCount = DCountWrapper("*", "Sales Analysis", "[Year]=" & Me.cbYear & " AND [Month]=" & Me.cbMonth)
    End Select
        
    If lOrderCount > 0 Then
        TempVars.Add "Group By", Me.lstSalesReports.Value
        TempVars.Add "Display", DLookupStringWrapper("[Display]", "Sales Reports", "[Group By]='" & Nz(Me.lstSalesReports) & "'")
        TempVars.Add "Year", Me.cbYear.Value
        TempVars.Add "Quarter", Me.cbQuarter.Value
        TempVars.Add "Month", Me.cbMonth.Value
        
        eh.TryToCloseObject
        DoCmd.OpenReport strReportName, ReportView, , strReportFilter, acWindowNormal
    Else
        MsgBoxOKOnly NoSalesInPeriod
    End If
End Sub


Private Sub Form_Load()
    SetSalesPeriod ByYear
    InitFilterItems
End Sub


Sub SetSalesPeriod(SalesPeriod As SalesPeriodEnum)
    Me.lstSalesPeriod = SalesPeriod
    Me.cbQuarter.Enabled = (SalesPeriod = ByQuarter)
    Me.cbMonth.Enabled = (SalesPeriod = ByMonth)
End Sub


Private Sub lstSalesPeriod_AfterUpdate()
    SetSalesPeriod Me.lstSalesPeriod
End Sub


Private Sub lstSalesReports_AfterUpdate()
    InitFilterItems
End Sub


Private Sub InitFilterItems()
    Me.lstReportFilter.RowSource = DLookupStringWrapper("[Filter Row Source]", "Sales Reports", "[Group By]='" & Nz(Me.lstSalesReports) & "'")
    Me.lstReportFilter = Null
End Sub


Private Sub cmdPreview_Click()
    PrintReports acViewReport
End Sub


Private Sub cmdPrint_Click()
    PrintReports acViewNormal
End Sub


Private Function GetLastOrderDate() As Date
    GetLastOrderDate = Nz(DMaxWrapper("[Order Date]", "Orders"), Date)
End Function
