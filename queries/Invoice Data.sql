SELECT Orders.[Order ID], Orders.[Ship Name], Customers.DV, Customers.RUC, Orders.[Ship Address], Customers.EsDoctor, Orders.[Ship City], Orders.[Ship State/Province], Orders.[Ship ZIP/Postal Code], Orders.[Ship Country/Region], Orders.[Customer ID], IIf([RazonSocial]<>"",[RazonSocial],[NombreCompleto]) AS [Customer Name], Customers.Direccion AS Address, Customers.Ciudad AS City, Customers.Provincia AS [State/Province], "" AS [ZIP/Postal Code], Customers.Pais AS [Country/Region], [Employees Extended].[Employee Name] AS Salesperson, Orders.[Order Date], Orders.[Shipped Date], Shippers.Company AS [Shipper Name], [Order Details].[Product ID], Products.ID AS [Product ID], [Order Details].[Unit Price], [Order Details].Quantity, [Order Details].Discount, IIf([AbsoluteDiscount]=0,CCur(([Quantity]*GetNrDaysRental([NrDaysRental]))*[Unit Price]*(1-[Discount])),CCur(([Quantity]*GetNrDaysRental([NrDaysRental]))*[Unit Price]-Nz([AbsoluteDiscount],0))) AS [Extended Price], Orders.[Shipping Fee], Orders.Taxes, Products.[Product Name], [Order Details].NrDaysRental, Orders.[Payment Type], IIf([RazonSocial]<>"",[RazonSocial],[NombreCompleto]) AS Client, [Employees Extended].Employee, Orders.[Order Date] AS StartDate, Orders.OrderType, Customers.NumeroDeIdentificacion, Customers.Celular, Customers.Correo, [Order Details].AbsoluteDiscount
FROM (Shippers RIGHT JOIN (Customers RIGHT JOIN (Orders LEFT JOIN [Employees Extended] ON Orders.[Employee ID] = [Employees Extended].ID) ON Customers.ID = Orders.[Customer ID]) ON Shippers.ID = Orders.[Shipper ID]) LEFT JOIN ([Order Details] LEFT JOIN Products ON [Order Details].[Product ID] = Products.ID) ON Orders.[Order ID] = [Order Details].[Order ID];
